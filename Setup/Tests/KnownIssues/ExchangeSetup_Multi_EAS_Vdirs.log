[12/09/2021 18:43:47.0953] [0] **********************************************
[12/09/2021 18:43:47.0965] [0] Starting Microsoft Exchange Server 2019 Setup
[12/09/2021 18:43:47.0965] [0] **********************************************
[12/09/2021 18:43:47.0969] [0] Local time zone: (UTC-05:00) Eastern Time (US & Canada).
[12/09/2021 18:43:47.0970] [0] Operating system version: Microsoft Windows NT 6.2.9200.0.
[12/09/2021 18:43:47.0974] [0] Setup version: 15.2.986.5.
[12/09/2021 18:43:47.0976] [0] Logged on user: SOLO\Han.
[12/09/2021 18:43:48.0015] [0] Command Line Parameter Name='mode', Value='Upgrade'.
[12/09/2021 18:43:48.0015] [0] Command Line Parameter Name='iacceptexchangeserverlicenseterms_diagnosticdataon', Value=''.
[12/09/2021 18:43:48.0015] [0] Command Line Parameter Name='sourcedir', Value='D:\'.
[12/09/2021 18:43:48.0230] [0] RuntimeAssembly was started with the following command: '/mode:upgrade /IAcceptExchangeServerLicenseTerms_DiagnosticDataON /sourcedir:D:"'.
[12/09/2021 18:43:48.0238] [0] The registry key, HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Exchange\v8.0, wasn't found.
[12/09/2021 18:43:48.0238] [0] The registry key, HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\ExchangeServer\v14, wasn't found.
[12/09/2021 18:43:48.0247] [0] Copying Files...
[12/09/2021 18:43:48.0254] [0] Starting copy from D:\Setup\ServerRoles\Common to C:\Windows\Temp\ExchangeSetup.
[12/09/2021 18:43:54.0187] [0] Finished copy from D:\Setup\ServerRoles\Common to C:\Windows\Temp\ExchangeSetup.
[12/09/2021 18:43:54.0189] [0] File copy complete.  Setup will now collect additional information needed for installation.

[12/09/2021 18:43:54.0197] [0] Assembly dll file location is C:\Windows\Temp\ExchangeSetup\Microsoft.Exchange.Setup.Console.dll
[12/09/2021 18:43:58.0557] [0] Setup is choosing the domain controller to use
[12/09/2021 18:43:58.0907] [0] The MSExchangeADTopology has a persisted domain controller: DC2.Solo.local
[12/09/2021 18:44:03.0198] [0] PrepareAD has either not been run or has not replicated to the domain controller used by Setup. Setup will attempt to use the Schema Master domain controller DC2.Solo.local
[12/09/2021 18:44:03.0202] [0] The schema master domain controller is available
[12/09/2021 18:44:03.0203] [0] The schema master domain controller is in the local domain; setup will use DC2.Solo.local
[12/09/2021 18:44:03.0214] [0] Setup is choosing a global catalog...
[12/09/2021 18:44:03.0281] [0] Setup has chosen the global catalog server DC2.Solo.local.
[12/09/2021 18:44:03.0293] [0] Setup will use the domain controller 'DC2.Solo.local'.
[12/09/2021 18:44:03.0294] [0] Setup will use the global catalog 'DC2.Solo.local'.
[12/09/2021 18:44:03.0298] [0] Exchange configuration container for the organization is 'CN=Microsoft Exchange,CN=Services,CN=Configuration,DC=Solo,DC=local'.
[12/09/2021 18:44:03.0311] [0] Exchange organization container for the organization is 'CN=SoloORG,CN=Microsoft Exchange,CN=Services,CN=Configuration,DC=Solo,DC=local'.
[12/09/2021 18:44:03.0346] [0] Setup will search for an Exchange Server object for the local machine with name 'ExSvr1'.
[12/09/2021 18:44:03.0684] [0] Exchange Server object found : 'CN=ExSvr1,CN=Servers,CN=Exchange Administrative Group (FYDIBOHF23SPDLT),CN=Administrative Groups,CN=SoloORG,CN=Microsoft Exchange,CN=Services,CN=Configuration,DC=Solo,DC=local'.
[12/09/2021 18:44:03.0820] [0] The following roles have been unpacked: BridgeheadRole ClientAccessRole MailboxRole FrontendTransportRole AdminToolsRole CafeRole
[12/09/2021 18:44:03.0824] [0] The following datacenter roles are unpacked:
[12/09/2021 18:44:03.0831] [0] The following roles are installed: BridgeheadRole ClientAccessRole MailboxRole FrontendTransportRole AdminToolsRole CafeRole
[12/09/2021 18:44:03.0837] [0] The local server has some Exchange files installed.
[12/09/2021 18:44:03.0859] [0] Server Name=ExSvr1
[12/09/2021 18:44:03.0859] [0] Setup will use the path 'D:\' for installing Exchange.
[12/09/2021 18:44:03.0862] [0] Setup will discover the installed roles from server object 'CN=ExSvr1,CN=Servers,CN=Exchange Administrative Group (FYDIBOHF23SPDLT),CN=Administrative Groups,CN=SoloORG,CN=Microsoft Exchange,CN=Services,CN=Configuration,DC=Solo,DC=local'.
[12/09/2021 18:44:03.0862] [0] 'BridgeheadRole' is installed on the server object.
[12/09/2021 18:44:03.0862] [0] 'ClientAccessRole' is installed on the server object.
[12/09/2021 18:44:03.0863] [0] 'MailboxRole' is installed on the server object.
[12/09/2021 18:44:03.0863] [0] 'CafeRole' is installed on the server object.
[12/09/2021 18:44:03.0863] [0] 'FrontendTransportRole' is installed on the server object.
[12/09/2021 18:44:03.0872] [0] The installation mode is set to: 'BuildToBuildUpgrade'.
[12/09/2021 18:44:10.0421] [0] An Exchange organization with name 'SoloORG' was found in this forest.
[12/09/2021 18:44:10.0422] [0] Active Directory Initialization status : 'True'.
[12/09/2021 18:44:10.0423] [0] Schema Update Required Status : 'False'.
[12/09/2021 18:44:10.0423] [0] Organization Configuration Update Required Status : 'True'.
[12/09/2021 18:44:10.0424] [0] Domain Configuration Update Required Status : 'True'.
[12/09/2021 18:44:10.0427] [0] The locally installed version is 15.2.922.7.
[12/09/2021 18:44:10.0428] [0] Exchange Installation Directory : 'C:\Program Files\Microsoft\Exchange Server\V15'.
[12/09/2021 18:44:10.0507] [0] Setup is determining what organization-level operations to perform.
[12/09/2021 18:44:10.0508] [0] Setup has detected a missing value. Setup is adding the value PrepareOrganization.
[12/09/2021 18:44:10.0508] [0] Setup has detected a missing value. Setup is adding the value PrepareDomain.
[12/09/2021 18:44:10.0509] [0] Because the value was specified, setup is setting the argument OrganizationName to the value SoloORG.
[12/09/2021 18:44:10.0567] [0] RootDataHandler has 1 DataHandlers
[12/09/2021 18:44:10.0567] [0]      Languages
[12/09/2021 18:44:10.0569] [0]      Management tools
[12/09/2021 18:44:10.0570] [0]      Mailbox role: Transport service
[12/09/2021 18:44:10.0571] [0]      Mailbox role: Client Access service
[12/09/2021 18:44:10.0571] [0]      Mailbox role: Mailbox service
[12/09/2021 18:44:10.0571] [0]      Mailbox role: Front End Transport service
[12/09/2021 18:44:10.0572] [0]      Mailbox role: Client Access Front End service
[12/09/2021 18:44:10.0590] [0] Validating options for the 6 requested roles
[12/09/2021 18:44:10.0591] [0] UpgradeModeDataHandler has 17 handlers and 17 work units
[12/09/2021 18:44:10.0656] [0] Performing Microsoft Exchange Server Prerequisite Check
[12/09/2021 18:44:10.0702] [0] Setup is determining what organization-level operations to perform.
[12/09/2021 18:44:10.0702] [0] Setup has detected a missing value. Setup is adding the value PrepareOrganization.
[12/09/2021 18:44:10.0702] [0] Setup has detected a missing value. Setup is adding the value PrepareDomain.
[12/09/2021 18:44:10.0702] [0] Because the value was specified, setup is setting the argument OrganizationName to the value SoloORG.
[12/09/2021 18:44:21.0227] [0] **************
[12/09/2021 18:44:33.0888] [1] Evaluated [Setting:ComputerNameDnsFullyQualified] [HasException:False] [Value:"ExSvr1.Solo.local"] [ParentValue:"<NULL>"] [Thread:21] [Duration:00:00:00.0030010]
          {
              $a = &"$windir\system32\inetsrv\appcmd.exe" "set" "config" "/section:system.webServer/modules" "/.[name=`'$moduleName`'].lockItem:false"
              Write-ExchangeSetupLog -Info ($a)
          }
[12/09/2021 19:22:58.0244] [2] Searching objects "ExSvr1" of type "Server" under the root "$null".
[12/09/2021 19:22:58.0299] [2] Previous operation run on domain controller 'DC2.Solo.local'.
[12/09/2021 19:22:59.0979] [2] Ending processing get-ActiveSyncVirtualDirectory
[12/09/2021 19:22:59.0990] [1] The following 1 error(s) occurred during task execution:
[12/09/2021 19:22:59.0990] [1] 0.  ErrorRecord: Cannot convert 'System.Object[]' to the type 'Microsoft.Exchange.Configuration.Tasks.VirtualDirectoryIdParameter' required by parameter 'Identity'. Specified method is not supported.
[12/09/2021 19:22:59.0991] [1] 0.  ErrorRecord: System.Management.Automation.ParameterBindingException: Cannot convert 'System.Object[]' to the type 'Microsoft.Exchange.Configuration.Tasks.VirtualDirectoryIdParameter' required by parameter 'Identity'. Specified method is not supported. ---> System.NotSupportedException: Specified method is not supported.
   at System.Management.Automation.ParameterBinderBase.CoerceTypeAsNeeded(CommandParameterInternal argument, String parameterName, Type toType, ParameterCollectionTypeInformation collectionTypeInfo, Object currentValue)
   --- End of inner exception stack trace ---
   at System.Management.Automation.CmdletParameterBinderController.VerifyArgumentsProcessed(ParameterBindingException originalBindingException)
   at System.Management.Automation.CmdletParameterBinderController.BindCommandLineParametersNoValidation(Collection`1 arguments)
   at System.Management.Automation.CmdletParameterBinderController.BindCommandLineParameters(Collection`1 arguments)
   at System.Management.Automation.CommandProcessor.BindCommandLineParameters()
   at System.Management.Automation.CommandProcessor.Prepare(IDictionary psDefaultParameterValues)
   at System.Management.Automation.CommandProcessorBase.DoPrepare(IDictionary psDefaultParameterValues)
   at System.Management.Automation.Internal.PipelineProcessor.Start(Boolean incomingStream)
   at System.Management.Automation.Internal.PipelineProcessor.SynchronousExecuteEnumerate(Object input)
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Management.Automation.Internal.PipelineProcessor.SynchronousExecuteEnumerate(Object input)
   at System.Management.Automation.PipelineOps.InvokePipeline(Object input, Boolean ignoreInput, CommandParameterInternal[][] pipeElements, CommandBaseAst[] pipeElementAsts, CommandRedirection[][] commandRedirections, FunctionContext funcContext)
   at System.Management.Automation.Interpreter.ActionCallInstruction`6.Run(InterpretedFrame frame)
   at System.Management.Automation.Interpreter.EnterTryCatchFinallyInstruction.Run(InterpretedFrame frame)
[12/09/2021 19:22:59.0994] [1] [ERROR] The following error was generated when "$error.Clear();
          $fe = get-ActiveSyncVirtualDirectory -server $RoleFqdnOrName -DomainController $RoleDomainController -ErrorAction SilentlyContinue;

          if ($fe -eq $null)
          {
            new-ActiveSyncVirtualDirectory -DomainController $RoleDomainController -Role ClientAccess;
          }
          else
          {
            update-ActiveSyncVirtualDirectory $fe -DomainController $RoleDomainController -InstallIsapiFilter $true
          }
        " was run: "System.Management.Automation.ParameterBindingException: Cannot convert 'System.Object[]' to the type 'Microsoft.Exchange.Configuration.Tasks.VirtualDirectoryIdParameter' required by parameter 'Identity'. Specified method is not supported. ---> System.NotSupportedException: Specified method is not supported.
   at System.Management.Automation.ParameterBinderBase.CoerceTypeAsNeeded(CommandParameterInternal argument, String parameterName, Type toType, ParameterCollectionTypeInformation collectionTypeInfo, Object currentValue)
   --- End of inner exception stack trace ---
   at System.Management.Automation.CmdletParameterBinderController.VerifyArgumentsProcessed(ParameterBindingException originalBindingException)
   at System.Management.Automation.CmdletParameterBinderController.BindCommandLineParametersNoValidation(Collection`1 arguments)
   at System.Management.Automation.CmdletParameterBinderController.BindCommandLineParameters(Collection`1 arguments)
   at System.Management.Automation.CommandProcessor.BindCommandLineParameters()
   at System.Management.Automation.CommandProcessor.Prepare(IDictionary psDefaultParameterValues)
   at System.Management.Automation.CommandProcessorBase.DoPrepare(IDictionary psDefaultParameterValues)
   at System.Management.Automation.Internal.PipelineProcessor.Start(Boolean incomingStream)
   at System.Management.Automation.Internal.PipelineProcessor.SynchronousExecuteEnumerate(Object input)
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Management.Automation.Internal.PipelineProcessor.SynchronousExecuteEnumerate(Object input)
   at System.Management.Automation.PipelineOps.InvokePipeline(Object input, Boolean ignoreInput, CommandParameterInternal[][] pipeElements, CommandBaseAst[] pipeElementAsts, CommandRedirection[][] commandRedirections, FunctionContext funcContext)
   at System.Management.Automation.Interpreter.ActionCallInstruction`6.Run(InterpretedFrame frame)
   at System.Management.Automation.Interpreter.EnterTryCatchFinallyInstruction.Run(InterpretedFrame frame)".
[12/09/2021 19:22:59.0994] [1] [ERROR] Cannot convert 'System.Object[]' to the type 'Microsoft.Exchange.Configuration.Tasks.VirtualDirectoryIdParameter' required by parameter 'Identity'. Specified method is not supported.
[12/09/2021 19:22:59.0995] [1] [ERROR] Specified method is not supported.
[12/09/2021 19:22:59.0995] [1] [ERROR-REFERENCE] Id=CafeComponent___e1130a139a734d90b6c5eec88868fbe9 Component=EXCHANGE14:\Current\Release\Shared\Datacenter\Setup
[12/09/2021 19:22:59.0996] [1] Setup is stopping now because of one or more critical errors.
[12/09/2021 19:22:59.0996] [1] Finished executing component tasks.
[12/09/2021 19:23:00.0056] [1] Ending processing Install-CafeRole
[12/09/2021 19:23:00.0071] [0] CurrentResult console.ProcessRunInternal:198: 1
[12/09/2021 19:23:00.0072] [0] CurrentResult launcherbase.maincore:90: 1
[12/09/2021 19:23:00.0072] [0] CurrentResult console.startmain:52: 1
[12/09/2021 19:23:00.0073] [0] CurrentResult SetupLauncherHelper.loadassembly:452: 1
[12/09/2021 19:23:00.0087] [0] The Exchange Server setup operation didn't complete.  More details can be found in ExchangeSetup.log located in the <SystemDrive>:\ExchangeSetupLogs folder.
[12/09/2021 19:23:00.0088] [0] CurrentResult main.run:235: 1
[12/09/2021 19:23:00.0088] [0] CurrentResult setupbase.maincore:396: 1
[12/09/2021 19:23:00.0095] [0] End of Setup
[12/09/2021 19:23:00.0095] [0] **********************************************
